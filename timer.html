<!DOCTYPE html>
<html>
    <head>
        <title>Example</title>
    </head>


    <body onload="my_on_load()">

       <script>
           var timer_inst
           var timer_count
           var TimeInterval = 1000

           var xmlhttp = new XMLHttpRequest();
           var url = "http://localhost:8080/status";

           xmlhttp.onreadystatechange = function() {
               if (this.readyState == 4 && this.status == 200) {
                   var dict = JSON.parse(this.responseText);
                   // DO SOMETHING HERE:
                   document.getElementById("id01").innerHTML = dict["SizeMB"] // timer_count
                   timer_count = dict["SizeMB"]
		   // Check the status after TimeInterval milliseconds, idle before that.
		   // Enable timer only after the successful transaction with the server.
                   timer_inst = setTimeout(timer_callback, TimeInterval)
               }
           };

           
// TODO: Possible backlog forming if AJAX requests are not returned within the interval?
           function timer_callback() {
               var IDVar = "ID="
               var PostPar = IDVar.concat(timer_count)
               xmlhttp.open("POST", url, true);
               xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
               
               xmlhttp.send(PostPar);
               // timer_count = timer_count + 1
               // if (timer_count > 5) clearInterval(timer_inst)
           }

           function my_on_load() {
               timer_count = 0
               // document.getElementById("id01").innerHTML = timer_count
               timer_inst = setTimeout(timer_callback, TimeInterval)
           }
       </script>

       <div id="id01"> To be replaced. </div>
        <p>This is an example of a simple HTML page with one paragraph.</p>
    </body>
</html>

